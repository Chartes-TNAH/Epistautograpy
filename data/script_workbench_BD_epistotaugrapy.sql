-- MySQL Script generated by MySQL Workbench
-- Sun Mar  1 11:45:28 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`USER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`USER` (
  `id_user` INT NOT NULL AUTO_INCREMENT,
  `nom_user` TINYTEXT NOT NULL,
  `login_user` VARCHAR(45) NOT NULL,
  `email_user` TINYTEXT NOT NULL,
  `password_user` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id_user`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`DESTINATAIRE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`DESTINATAIRE` (
  `id_destinataire` INT NOT NULL AUTO_INCREMENT,
  `type_destinataire` VARCHAR(45) NOT NULL,
  `titre_destinataire` TINYTEXT NULL,
  `identite_destinataire` TINYTEXT NOT NULL,
  `date_naissance` DATETIME NULL,
  `date_deces` DATETIME NULL,
  PRIMARY KEY (`id_destinataire`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`INSTITUTION_CONSERVATION`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`INSTITUTION_CONSERVATION` (
  `id_institution_conservation` INT NOT NULL AUTO_INCREMENT,
  `nom_institution_conservation` VARCHAR(45) NOT NULL,
  `latitude_institution_conservation` FLOAT NOT NULL,
  `longitude_institution_conservation` FLOAT NOT NULL,
  PRIMARY KEY (`id_institution_conservation`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`LETTRE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`LETTRE` (
  `id_lettre` INT NOT NULL AUTO_INCREMENT,
  `date_envoie_lettre` DATETIME NOT NULL,
  `lieu_ecriture_lettre` VARCHAR(45) NOT NULL,
  `objet_lettre` TINYTEXT NULL,
  `contresignataire_lettre` VARCHAR(45) NULL,
  `langue_lettre` VARCHAR(45) NOT NULL,
  `pronom_personnel_employe_lettre` VARCHAR(45) NULL,
  `cote_lettre` VARCHAR(45) NOT NULL,
  `statut_lettre` VARCHAR(45) NOT NULL,
  `INSTITUTION_CONSERVATION_id_institution_conservation` INT NOT NULL,
  PRIMARY KEY (`id_lettre`),
  INDEX `fk_LETTRE_INSTITUTION_CONSERVATION1_idx` (`INSTITUTION_CONSERVATION_id_institution_conservation` ASC),
  CONSTRAINT `fk_LETTRE_INSTITUTION_CONSERVATION1`
    FOREIGN KEY (`INSTITUTION_CONSERVATION_id_institution_conservation`)
    REFERENCES `mydb`.`INSTITUTION_CONSERVATION` (`id_institution_conservation`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`IMAGE_NUMERISEE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`IMAGE_NUMERISEE` (
  `id_image_numerisee` INT NOT NULL AUTO_INCREMENT,
  `url_image_numerisee` TEXT NOT NULL,
  `reference_bibliographique_image_numerisee` TEXT NOT NULL,
  `LETTRE_id_lettre` INT NOT NULL,
  PRIMARY KEY (`id_image_numerisee`),
  INDEX `fk_IMAGE_NUMERISEE_LETTRE1_idx` (`LETTRE_id_lettre` ASC),
  CONSTRAINT `fk_IMAGE_NUMERISEE_LETTRE1`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`AUTHORSHIP`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`AUTHORSHIP` (
  `id_authorship` INT NOT NULL AUTO_INCREMENT,
  `USER_id_user` INT NOT NULL,
  `DESTINATAIRE_id_destinataire` INT NOT NULL,
  `date_authorship` DATETIME NOT NULL,
  PRIMARY KEY (`id_authorship`),
  INDEX `fk_USER_has_DESTINATAIRE_DESTINATAIRE1_idx` (`DESTINATAIRE_id_destinataire` ASC),
  INDEX `fk_USER_has_DESTINATAIRE_USER_idx` (`USER_id_user` ASC),
  CONSTRAINT `fk_USER_has_DESTINATAIRE_USER`
    FOREIGN KEY (`USER_id_user`)
    REFERENCES `mydb`.`USER` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_has_DESTINATAIRE_DESTINATAIRE1`
    FOREIGN KEY (`DESTINATAIRE_id_destinataire`)
    REFERENCES `mydb`.`DESTINATAIRE` (`id_destinataire`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`LETTRE_has_USER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`LETTRE_has_USER` (
  `LETTRE_id_lettre` INT NOT NULL,
  `USER_id_user` INT NOT NULL,
  PRIMARY KEY (`USER_id_user`),
  INDEX `fk_LETTRE_has_USER_USER1_idx` (`USER_id_user` ASC),
  INDEX `fk_LETTRE_has_USER_LETTRE1_idx` (`LETTRE_id_lettre` ASC),
  CONSTRAINT `fk_LETTRE_has_USER_LETTRE1`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LETTRE_has_USER_USER1`
    FOREIGN KEY (`USER_id_user`)
    REFERENCES `mydb`.`USER` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`USER_has_DESTINATAIRE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`USER_has_DESTINATAIRE` (
  `USER_id_user` INT NOT NULL,
  `DESTINATAIRE_id_destinataire` INT NOT NULL,
  PRIMARY KEY (`USER_id_user`, `DESTINATAIRE_id_destinataire`),
  INDEX `fk_USER_has_DESTINATAIRE_DESTINATAIRE2_idx` (`DESTINATAIRE_id_destinataire` ASC),
  INDEX `fk_USER_has_DESTINATAIRE_USER1_idx` (`USER_id_user` ASC),
  CONSTRAINT `fk_USER_has_DESTINATAIRE_USER1`
    FOREIGN KEY (`USER_id_user`)
    REFERENCES `mydb`.`USER` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_has_DESTINATAIRE_DESTINATAIRE2`
    FOREIGN KEY (`DESTINATAIRE_id_destinataire`)
    REFERENCES `mydb`.`DESTINATAIRE` (`id_destinataire`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`LETTRE_has_USER_has_DESTINATAIRE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`LETTRE_has_USER_has_DESTINATAIRE` (
  `LETTRE_id_lettre` INT NOT NULL,
  `USER_has_DESTINATAIRE_USER_id_user` INT NOT NULL,
  `USER_has_DESTINATAIRE_DESTINATAIRE_id_destinataire` INT NOT NULL,
  PRIMARY KEY (`LETTRE_id_lettre`, `USER_has_DESTINATAIRE_USER_id_user`, `USER_has_DESTINATAIRE_DESTINATAIRE_id_destinataire`),
  INDEX `fk_LETTRE_has_USER_has_DESTINATAIRE_USER_has_DESTINATAIRE1_idx` (`USER_has_DESTINATAIRE_USER_id_user` ASC, `USER_has_DESTINATAIRE_DESTINATAIRE_id_destinataire` ASC),
  INDEX `fk_LETTRE_has_USER_has_DESTINATAIRE_LETTRE1_idx` (`LETTRE_id_lettre` ASC),
  CONSTRAINT `fk_LETTRE_has_USER_has_DESTINATAIRE_LETTRE1`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LETTRE_has_USER_has_DESTINATAIRE_USER_has_DESTINATAIRE1`
    FOREIGN KEY (`USER_has_DESTINATAIRE_USER_id_user` , `USER_has_DESTINATAIRE_DESTINATAIRE_id_destinataire`)
    REFERENCES `mydb`.`USER_has_DESTINATAIRE` (`USER_id_user` , `DESTINATAIRE_id_destinataire`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`AUTHORSHIP`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`AUTHORSHIP` (
  `id_authorship` INT NOT NULL AUTO_INCREMENT,
  `USER_id_user` INT NOT NULL,
  `LETTRE_id_lettre` INT NOT NULL,
  `date_authorship` DATETIME NOT NULL,
  PRIMARY KEY (`id_authorship`),
  INDEX `fk_USER_has_LETTRE_LETTRE2_idx` (`LETTRE_id_lettre` ASC),
  INDEX `fk_USER_has_LETTRE_USER2_idx` (`USER_id_user` ASC),
  CONSTRAINT `fk_USER_has_LETTRE_USER2`
    FOREIGN KEY (`USER_id_user`)
    REFERENCES `mydb`.`USER` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_has_LETTRE_LETTRE2`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`LETTRE_has_AUTHORSHIP`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`LETTRE_has_AUTHORSHIP` (
  `LETTRE_id_lettre` INT NOT NULL,
  `AUTHORSHIP_DESTINATAIRE_id_destinataire` INT NOT NULL,
  `AUTHORSHIP_USER_has_LETTRE_USER_id_user` INT NOT NULL,
  `AUTHORSHIP_USER_has_LETTRE_LETTRE_id_lettre` INT NOT NULL,
  PRIMARY KEY (`LETTRE_id_lettre`, `AUTHORSHIP_DESTINATAIRE_id_destinataire`, `AUTHORSHIP_USER_has_LETTRE_USER_id_user`, `AUTHORSHIP_USER_has_LETTRE_LETTRE_id_lettre`),
  INDEX `fk_LETTRE_has_AUTHORSHIP_AUTHORSHIP1_idx` (`AUTHORSHIP_DESTINATAIRE_id_destinataire` ASC, `AUTHORSHIP_USER_has_LETTRE_USER_id_user` ASC, `AUTHORSHIP_USER_has_LETTRE_LETTRE_id_lettre` ASC),
  INDEX `fk_LETTRE_has_AUTHORSHIP_LETTRE1_idx` (`LETTRE_id_lettre` ASC),
  CONSTRAINT `fk_LETTRE_has_AUTHORSHIP_LETTRE1`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LETTRE_has_AUTHORSHIP_AUTHORSHIP1`
    FOREIGN KEY (`AUTHORSHIP_DESTINATAIRE_id_destinataire` , `AUTHORSHIP_USER_has_LETTRE_USER_id_user` , `AUTHORSHIP_USER_has_LETTRE_LETTRE_id_lettre`)
    REFERENCES `mydb`.`AUTHORSHIP` (`DESTINATAIRE_id_destinataire` , `USER_has_LETTRE_USER_id_user` , `USER_has_LETTRE_LETTRE_id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`AUTHORSHIP`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`AUTHORSHIP` (
  `id_authorship` INT NOT NULL AUTO_INCREMENT,
  `USER_id_user` INT NOT NULL,
  `LETTRE_id_lettre` INT NOT NULL,
  `date_authorship` DATETIME NOT NULL,
  PRIMARY KEY (`id_authorship`),
  INDEX `fk_USER_has_LETTRE_LETTRE2_idx` (`LETTRE_id_lettre` ASC),
  INDEX `fk_USER_has_LETTRE_USER2_idx` (`USER_id_user` ASC),
  CONSTRAINT `fk_USER_has_LETTRE_USER2`
    FOREIGN KEY (`USER_id_user`)
    REFERENCES `mydb`.`USER` (`id_user`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_has_LETTRE_LETTRE2`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`CORRESPONDANCE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CORRESPONDANCE` (
  `id_correspondance` INT NOT NULL AUTO_INCREMENT,
  `LETTRE_id_lettre` INT NOT NULL,
  `DESTINATAIRE_id_destinataire` INT NOT NULL,
  INDEX `fk_LETTRE_has_DESTINATAIRE_DESTINATAIRE1_idx` (`DESTINATAIRE_id_destinataire` ASC),
  INDEX `fk_LETTRE_has_DESTINATAIRE_LETTRE1_idx` (`LETTRE_id_lettre` ASC),
  PRIMARY KEY (`id_correspondance`, `LETTRE_id_lettre`, `DESTINATAIRE_id_destinataire`),
  CONSTRAINT `fk_LETTRE_has_DESTINATAIRE_LETTRE1`
    FOREIGN KEY (`LETTRE_id_lettre`)
    REFERENCES `mydb`.`LETTRE` (`id_lettre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LETTRE_has_DESTINATAIRE_DESTINATAIRE1`
    FOREIGN KEY (`DESTINATAIRE_id_destinataire`)
    REFERENCES `mydb`.`DESTINATAIRE` (`id_destinataire`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
